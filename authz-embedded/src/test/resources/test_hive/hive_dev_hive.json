{
    "serviceId": 5, "serviceName": "dev_hive", "policyVersion": 15,
    "policies": [
        {
            "id": 1, "name": "mydb.tbl1", "version": 1,
            "resources": { "database": { "values": [ "mydb" ] }, "table": { "values": [ "tbl1" ] }, "column": { "values": [ "*" ] } },
            "policyItems": [
                { "accesses": [ { "type": "select" } ], "users": [ "tbl1-r-user" ] },
                { "accesses": [ { "type": "select" },  { "type": "update" } ], "users": [ "tbl1-rw-user" ] }
            ]
        },
        {
            "id": 2, "name": "mydb.tbl2", "version": 1,
            "resources": { "database": { "values": [ "mydb" ] }, "table": { "values": [ "tbl2" ] }, "column": { "values": [ "*" ] } },
            "policyItems": [
                { "accesses": [ { "type": "select" } ], "users": [ "tbl2-r-user" ] },
                { "accesses": [ { "type": "select" },  { "type": "update" } ], "users": [ "tbl2-rw-user" ] }
            ]
        },
        {
            "id": 3, "name": "mydb.*.*", "version": 2,
            "resources": { "database": { "values": [ "mydb" ] }, "table": { "values": [ "*" ] }, "column": { "values": [ "*" ] } },
            "policyItems": [
                { "accesses": [ { "type": "select" } ], "users": [ "all-tbl-r-user" ] }
            ]
        }
    ],
    "serviceDef": {
        "id": 3, "name": "hive", "displayName": "Hadoop SQL", "label": "Hadoop SQL", "description": "Hadoop SQL", "implClass": "org.apache.ranger.services.hive.RangerServiceHive", "version": 1,
        "resources": [
            {
                "itemId": 1, "name": "database", "description": "Hive Database", "label": "Hive Database", "type": "string", "level": 10,
                "excludesSupported": true, "isValidLeaf": true, "lookupSupported": true, "mandatory": true, "recursiveSupported": false,
                "matcher": "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher", "matcherOptions": { "ignoreCase": "true", "wildCard": "true" }
            },
            {
                "itemId": 2, "name": "table", "description": "Hive Table", "label": "Hive Table", "type": "string", "parent": "database", "level": 20,
                "excludesSupported": true, "isValidLeaf": true, "lookupSupported": true, "mandatory": true, "recursiveSupported": false,
                "matcher": "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher", "matcherOptions": { "ignoreCase": "true", "wildCard": "true" }
            },
            {
                "itemId": 3, "name": "udf", "description": "Hive UDF", "label": "Hive UDF", "type": "string", "parent": "database", "level": 20,
                "excludesSupported": true, "isValidLeaf": true, "lookupSupported": true, "mandatory": true, "recursiveSupported": false,
                "matcher": "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher", "matcherOptions": { "ignoreCase": "true", "wildCard": "true" }
            },
            {
                "itemId": 4, "name": "column", "description": "Hive Column", "label": "Hive Column", "type": "string", "parent": "table", "level": 30,
                "excludesSupported": true, "isValidLeaf": true, "lookupSupported": true, "mandatory": true, "recursiveSupported": false,
                "matcher": "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher", "matcherOptions": { "ignoreCase": "true", "wildCard": "true" }
            },
            {
                "itemId": 5, "name": "url", "description": "URL", "label": "URL", "type": "string", "parent": "", "level": 10,
                "excludesSupported": false, "isValidLeaf": true, "lookupSupported": false, "mandatory": true, "recursiveSupported": true,
                "matcher": "org.apache.ranger.plugin.resourcematcher.RangerURLResourceMatcher", "matcherOptions": { "ignoreCase": "false", "wildCard": "true" }
            },
            {
                "itemId": 6, "name": "hiveservice", "description": "Hive Service", "label": "Hive Service", "type": "string", "parent": "", "level": 10,
                "excludesSupported": false, "isValidLeaf": true, "lookupSupported": false, "mandatory": true, "recursiveSupported": false,
                "matcher": "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher", "matcherOptions": { "ignoreCase": "false", "wildCard": "true" }
            },
            {
                "itemId": 7, "name": "global", "description": "Global", "label": "Global", "type": "string", "parent": "", "level": 10,
                "excludesSupported": false, "isValidLeaf": true, "lookupSupported": false, "mandatory": true, "recursiveSupported": false,
                "matcher": "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher", "matcherOptions": { "ignoreCase": "false", "wildCard": "true" }
            }
        ],
        "accessTypes": [
            { "itemId": 1,  "name": "select",       "label": "select",              "category": "READ" },
            { "itemId": 2,  "name": "update",       "label": "update",              "category": "UPDATE" },
            { "itemId": 3,  "name": "create",       "label": "Create",              "category": "CREATE" },
            { "itemId": 4,  "name": "drop",         "label": "Drop",                "category": "DELETE" },
            { "itemId": 5,  "name": "alter",        "label": "Alter",               "category": "CREATE" },
            { "itemId": 6,  "name": "index",        "label": "Index",               "category": "MANAGE" },
            { "itemId": 7,  "name": "lock",         "label": "Lock",                "category": "MANAGE" },
            { "itemId": 8,  "name": "all",          "label": "All",                 "impliedGrants": [ "select", "update", "create", "drop", "alter", "index", "lock", "read", "write", "repladmin", "serviceadmin", "refresh" ] },
            { "itemId": 9,  "name": "read",         "label": "Read",                "category": "READ" },
            { "itemId": 10, "name": "write",        "label": "Write",               "category": "UPDATE" },
            { "itemId": 11, "name": "repladmin",    "label": "ReplAdmin",           "category": "MANAGE" },
            { "itemId": 12, "name": "serviceadmin", "label": "Service Admin",       "category": "MANAGE" },
            { "itemId": 13, "name": "tempudfadmin", "label": "Temporary UDF Admin", "category": "MANAGE" },
            { "itemId": 14, "name": "refresh",      "label": "Refresh",             "category": "MANAGE" }
        ],
        "policyConditions": [
            {
                "itemId": 1, "name": "_expression", "description": "Boolean expression", "label": "Enter boolean expression",
                "evaluator": "org.apache.ranger.plugin.conditionevaluator.RangerScriptConditionEvaluator", "evaluatorOptions": { "engineName": "JavaScript", "ui.isMultiline": "true" },
                "uiHint": "{ \"isMultiline\":true }"
            }
        ],
        "configs": [
            { "itemId": 1, "name": "username",                    "label": "Username",                     "mandatory": true,  "type": "string" },
            { "itemId": 2, "name": "password",                    "label": "Password",                     "mandatory": true,  "type": "password" },
            { "itemId": 3, "name": "jdbc.driverClassName",        "label": "jdbc.driverClassName",         "mandatory": true,  "type": "string", "defaultValue": "org.apache.hive.jdbc.HiveDriver" },
            { "itemId": 4, "name": "jdbc.url",                    "label": "jdbc.url" ,                    "mandatory": true,  "type": "string" },
            { "itemId": 5, "name": "commonNameForCertificate",    "label": "Common Name for Certificate",  "mandatory": false, "type": "string" },
            { "itemId": 6, "name": "ranger.plugin.audit.filters", "label": "Ranger Default Audit Filters", "mandatory": false, "type": "string", "defaultValue": "[ {'accessResult': 'DENIED', 'isAudited': true} ]" }
        ],
        "options": { "enableDenyAndExceptionsInPolicies": "true",  "enableTagBasedPolicies": "true" },
        "markerAccessTypes": [
            { "itemId": 101, "label": "_CREATE", "name": "_CREATE", "impliedGrants": [ "create", "alter" ] },
            { "itemId": 102, "label": "_READ",   "name": "_READ",   "impliedGrants": [ "select", "read" ] },
            { "itemId": 103, "label": "_UPDATE", "name": "_UPDATE", "impliedGrants": [ "update", "write" ] },
            { "itemId": 104, "label": "_DELETE", "name": "_DELETE", "impliedGrants": [ "drop" ] },
            { "itemId": 105, "label": "_MANAGE", "name": "_MANAGE", "impliedGrants": [ "tempudfadmin", "serviceadmin", "index", "lock", "refresh", "repladmin" ] },
            { "itemId": 106, "label": "_ALL",    "name": "_ALL",    "impliedGrants": [ "drop", "all", "select", "read", "update", "index", "refresh", "tempudfadmin", "serviceadmin", "create", "lock", "repladmin", "write", "alter" ] }
        ],
        "dataMaskDef": {
            "accessTypes": [
                { "itemId": 1, "name": "select", "label": "select", "category": "READ" }
            ],
            "resources": [
                {
                    "itemId": 1, "name": "database", "description": "Hive Database", "label": "Hive Database", "type": "string", "level": 10,
                    "excludesSupported": false, "isValidLeaf": false, "lookupSupported": true, "mandatory": true, "recursiveSupported": false,
                    "matcher": "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher", "matcherOptions": { "ignoreCase": "true", "wildCard": "false" },
                    "uiHint": "{ \"singleValue\":true }"
                },
                {
                    "itemId": 2, "name": "table", "description": "Hive Table", "label": "Hive Table", "type": "string", "parent": "database", "level": 20,
                    "excludesSupported": false, "isValidLeaf": false, "lookupSupported": true, "mandatory": true, "recursiveSupported": false,
                    "matcher": "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher", "matcherOptions": { "ignoreCase": "true", "wildCard": "false" },
                    "uiHint": "{ \"singleValue\":true }"
                },
                {
                    "itemId": 4, "name": "column", "description": "Hive Column", "label": "Hive Column", "type": "string", "parent": "table", "level": 30,
                    "excludesSupported": false, "isValidLeaf": true, "lookupSupported": true, "mandatory": true, "recursiveSupported": false,
                    "matcher": "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher", "matcherOptions": { "ignoreCase": "true", "wildCard": "false" },
                    "uiHint": "{ \"singleValue\":true }"
                }
            ],
            "maskTypes": [
                { "itemId": 1, "name": "MASK",                "label": "Redact",                           "description": "Replace lowercase with 'x', uppercase with 'X', digits with '0'", "transformer": "mask({col})" },
                { "itemId": 2, "name": "MASK_SHOW_LAST_4",    "label": "Partial mask: show last 4",        "description": "Show last 4 characters; replace rest with 'x'",                   "transformer": "mask_show_last_n({col}, 4, 'x', 'x', 'x', -1, '1')" },
                { "itemId": 3, "name": "MASK_SHOW_FIRST_4",   "label": "Partial mask: show first 4",       "description": "Show first 4 characters; replace rest with 'x'",                  "transformer": "mask_show_first_n({col}, 4, 'x', 'x', 'x', -1, '1')" },
                { "itemId": 4, "name": "MASK_HASH",           "label": "Hash",                             "description": "Hash the value",                                                  "transformer": "mask_hash({col})"},
                { "itemId": 5, "name": "MASK_NULL",           "label": "Nullify",                          "description": "Replace with NULL" },
                { "itemId": 6, "name": "MASK_NONE",           "label": "Unmasked (retain original value)", "description": "No masking" },
                { "itemId": 7, "name": "MASK_DATE_SHOW_YEAR", "label": "Date: show only year",             "transformer": "mask({col}, 'x', 'x', 'x', -1, '1', 1, 0, -1)",                   "description": "Date: show only year" },
                { "itemId": 8, "name": "CUSTOM",              "label": "Custom",                           "description": "Custom" }
            ]
        },
        "rowFilterDef": {
            "accessTypes": [
                { "itemId": 1, "name": "select", "label": "select", "category": "READ" }
            ],
            "resources": [
                {
                    "itemId": 1, "name": "database", "description": "Hive Database", "label": "Hive Database", "type": "string", "level": 10,
                    "excludesSupported": false, "isValidLeaf": false, "lookupSupported": true, "mandatory": true, "recursiveSupported": false,
                    "matcher": "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher", "matcherOptions": { "ignoreCase": "true", "wildCard": "false" },
                    "uiHint": "{ \"singleValue\":true }"
                },
                {
                    "itemId": 2, "name": "table", "description": "Hive Table", "label": "Hive Table", "type": "string", "parent": "database", "level": 20,
                    "excludesSupported": false, "isValidLeaf": true, "lookupSupported": true, "mandatory": true, "recursiveSupported": false,
                    "matcher": "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher", "matcherOptions": { "ignoreCase": "true", "wildCard": "false" },
                    "uiHint": "{ \"singleValue\":true }"
                }
            ]
        }
    },
    "tagPolicies": {
        "serviceId": 3, "serviceName": "dev_tag", "policyVersion": 3,
        "policies": [
            {
                "id": 11, "name": "TAG1", "version": 1,
                "resources": { "tag": { "values": [ "TAG1" ] } },
                "policyItems": [
                    { "accesses": [ { "type": "select" } ], "users": [ "all-tag-r-user", "tag1-r-user" ] },
                    { "accesses": [ { "type": "select" }, { "type": "update" } ], "users": [ "tag1-rw-user" ] }
                ]
            },
            {
                "id": 12, "name": "TAG2", "version": 1,
                "resources": { "tag": { "values": [ "TAG2" ] } },
                "policyItems": [
                    { "accesses": [ { "type": "select" } ], "users": [ "all-tag-r-user", "tag2-r-user" ] },
                    { "accesses": [ { "type": "select" }, { "type": "update" } ], "users": [ "tag2-rw-user" ] }
                ]
            },
            {
                "id": 13, "name": "TAG-X", "version": 1,
                "resources": { "tag": { "values": [ "TAG-X" ] } },
                "policyItems": [
                    { "accesses": [ { "isAllowed": true, "type": "select" } ], "users": [ "all-tag-r-user" ] }
                ]
            }
        ],
        "serviceDef": {
            "id": 100, "name": "tag", "displayName": "tag", "label": "TAG", "description": "TAG Service Definition", "implClass": "org.apache.ranger.services.tag.RangerServiceTag", "version": 21,
            "resources": [
                {
                    "itemId": 1, "name": "tag", "label": "TAG", "description": "TAG", "level": 1, "type": "string",
                    "excludesSupported": false, "isValidLeaf": true, "lookupSupported": true, "mandatory": true, "recursiveSupported": false,
                    "matcher": "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher", "matcherOptions": { "ignoreCase": "false", "wildCard": "false" },
                    "uiHint": "{ \"singleValue\":true }"
                }
            ],
            "accessTypes": [
                { "itemId": 3001, "name": "select",       "label": "select",              "category": "READ" },
                { "itemId": 3002, "name": "update",       "label": "update",              "category": "UPDATE" },
                { "itemId": 3003, "name": "create",       "label": "Create",              "category": "CREATE" },
                { "itemId": 3004, "name": "drop",         "label": "Drop",                "category": "DELETE" },
                { "itemId": 3005, "name": "alter",        "label": "Alter",               "category": "CREATE" },
                { "itemId": 3006, "name": "index",        "label": "Index",               "category": "MANAGE" },
                { "itemId": 3007, "name": "lock",         "label": "Lock",                "category": "MANAGE" },
                { "itemId": 3008, "name": "all",          "label": "All",                 "impliedGrants": [ "select", "update", "create", "drop", "alter", "index", "lock", "read", "write", "repladmin", "serviceadmin", "refresh" ] },
                { "itemId": 3009, "name": "read",         "label": "Read",                "category": "READ" },
                { "itemId": 3010, "name": "write",        "label": "Write",               "category": "UPDATE" },
                { "itemId": 3011, "name": "repladmin",    "label": "ReplAdmin",           "category": "MANAGE" },
                { "itemId": 3012, "name": "serviceadmin", "label": "Service Admin",       "category": "MANAGE" },
                { "itemId": 3013, "name": "tempudfadmin", "label": "Temporary UDF Admin", "category": "MANAGE" },
                { "itemId": 3014, "name": "refresh",      "label": "Refresh",             "category": "MANAGE" }
            ],
            "policyConditions": [
                {
                    "itemId": 1, "name": "accessed-after-expiry", "label": "Accessed after expiry_date (yes/no)?", "description": "Accessed after expiry_date? (yes/no)",
                    "evaluator": "org.apache.ranger.plugin.conditionevaluator.RangerScriptTemplateConditionEvaluator", "evaluatorOptions": { "scriptTemplate": "ctx.isAccessedAfter('expiry_date');" },
                    "uiHint": "{ \"singleValue\":true }"
                },
                {
                    "itemId": 2, "name": "expression", "label": "Enter boolean expression", "description": "Boolean expression",
                    "evaluator": "org.apache.ranger.plugin.conditionevaluator.RangerScriptConditionEvaluator", "evaluatorOptions": { "engineName": "JavaScript", "ui.isMultiline": "true" },
                    "uiHint": "{ \"isMultiline\":true }"
                }
            ],
            "configs": [
                { "itemId": 1, "name": "ranger.plugin.audit.filters", "label": "Ranger Default Audit Filters", "mandatory": false, "type": "string", "defaultValue": "[ {'accessResult': 'DENIED', 'isAudited': true} ]" }
            ],
            "contextEnrichers": [
                { "itemId": 1, "name": "TagEnricher", "enricher": "org.apache.ranger.plugin.contextenricher.RangerTagEnricher", "enricherOptions": { "tagRetrieverClassName": "org.apache.ranger.plugin.contextenricher.RangerAdminTagRetriever", "tagRefresherPollingInterval": "60000" } }
            ],
            "markerAccessTypes": [
                { "itemId": 250101, "label": "_CREATE", "name": "_CREATE", "impliedGrants": [ "create", "alter" ] },
                { "itemId": 250102, "label": "_READ",   "name": "_READ",   "impliedGrants": [ "select", "read" ] },
                { "itemId": 250103, "label": "_UPDATE", "name": "_UPDATE", "impliedGrants": [ "update", "write" ] },
                { "itemId": 250104, "label": "_DELETE", "name": "_DELETE", "impliedGrants": [ "drop" ] },
                { "itemId": 250105, "label": "_MANAGE", "name": "_MANAGE", "impliedGrants": [ "tempudfadmin", "serviceadmin", "index", "lock", "refresh", "repladmin" ] },
                { "itemId": 250106, "label": "_ALL",    "name": "_ALL",    "impliedGrants": [ "drop", "all", "select", "read", "update", "index", "refresh", "tempudfadmin", "serviceadmin", "create", "lock", "repladmin", "write", "alter" ] }
            ],
            "dataMaskDef": {
                "accessTypes": [
                    { "itemId": 3001, "name": "select", "label": "select", "category": "READ" }
                ],
                "resources": [
                    {
                        "itemId": 1, "name": "tag", "label": "TAG", "description": "TAG", "level": 1, "type": "string",
                        "excludesSupported": false, "isValidLeaf": true, "lookupSupported": true, "mandatory": true, "recursiveSupported": false,
                        "matcher": "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher", "matcherOptions": { "ignoreCase": "false", "wildCard": "false" },
                        "uiHint": "{ \"singleValue\":true }"
                    }
                ],
                "maskTypes": [
                    { "itemId": 3001, "name": "hive:MASK",                "label": "Redact",                           "description": "Replace lowercase with 'x', uppercase with 'X', digits with '0'", "transformer": "mask({col})" },
                    { "itemId": 3002, "name": "hive:MASK_SHOW_LAST_4",    "label": "Partial mask: show last 4",        "description": "Show last 4 characters; replace rest with 'x'",                   "transformer": "mask_show_last_n({col}, 4, 'x', 'x', 'x', -1, '1')" },
                    { "itemId": 3003, "name": "hive:MASK_SHOW_FIRST_4",   "label": "Partial mask: show first 4",       "description": "Show first 4 characters; replace rest with 'x'",                  "transformer": "mask_show_first_n({col}, 4, 'x', 'x', 'x', -1, '1')" },
                    { "itemId": 3004, "name": "hive:MASK_HASH",           "label": "Hash",                             "description": "Hash the value",                                                  "transformer": "mask_hash({col})"},
                    { "itemId": 3005, "name": "hive:MASK_NULL",           "label": "Nullify",                          "description": "Replace with NULL" },
                    { "itemId": 3006, "name": "hive:MASK_NONE",           "label": "Unmasked (retain original value)", "description": "No masking" },
                    { "itemId": 3007, "name": "hive:MASK_DATE_SHOW_YEAR", "label": "Date: show only year",             "transformer": "mask({col}, 'x', 'x', 'x', -1, '1', 1, 0, -1)",                   "description": "Date: show only year" },
                    { "itemId": 3008, "name": "hive:CUSTOM",              "label": "Custom",                           "description": "Custom" }
                ]
            }
        }
    }
}
