[
  {
    "comment": "tests for tbl mydb.tbl1"
  },
  {
    "request": {
      "requestId": "tbl1-r-user select mydb.tbl1",
      "user":      { "name": "tbl1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl1" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl1-r-user select mydb.tbl1",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 1, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tbl1-r-user update mydb.tbl1",
      "user":      { "name": "tbl1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl1" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl1-r-user update mydb.tbl1",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tbl1-r-user select,update mydb.tbl1",
      "user":      { "name": "tbl1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl1" }, "action": "update", "permissions": [ "select", "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl1-r-user select,update mydb.tbl1",
      "decision":  "DENY",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id":  1, "version": 1 } } },
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tbl1-rw-user update mydb.tbl1",
      "user":      { "name": "tbl1-rw-user" },
      "access":    { "resource": { "name": "table:mydb.tbl1" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl1-rw-user update mydb.tbl1",
      "decision":  "ALLOW",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "ALLOW", "policy": { "id":  1, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tbl1-rw-user select,update mydb.tbl1",
      "user":      { "name": "tbl1-rw-user" },
      "access":    { "resource": { "name": "table:mydb.tbl1" }, "action": "update", "permissions": [ "select", "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl1-rw-user select,update mydb.tbl1",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id":  1, "version": 1 } } },
        "update": { "permission": "update", "access": { "decision": "ALLOW", "policy": { "id":  1, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tbl2-r-user select mydb.tbl1",
      "user":      { "name": "tbl2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl1" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl2-r-user select mydb.tbl1",
      "decision":  "DENY",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tbl2-r-user update mydb.tbl1",
      "user":      { "name": "tbl2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl1" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl2-r-user update mydb.tbl1",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "all-tbl-r-user select mydb.tbl1",
      "user":      { "name": "all-tbl-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl1" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "all-tbl-r-user select mydb.tbl1",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 3, "version": 2 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "all-tbl-r-user update mydb.tbl1",
      "user":      { "name": "all-tbl-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl1" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "all-tbl-r-user update mydb.tbl1",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },

  {
    "comment": "tests for tbl mydb.tbl2"
  },
  {
    "request": {
      "requestId": "tbl2-r-user select mydb.tbl2",
      "user":      { "name": "tbl2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl2" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl2-r-user select mydb.tbl2",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 2, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tbl2-r-user update mydb.tbl2",
      "user":      { "name": "tbl2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl2" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl2-r-user update mydb.tbl2",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tbl2-r-user select,update mydb.tbl2",
      "user":      { "name": "tbl2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl2" }, "action": "update", "permissions": [ "select", "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl2-r-user select,update mydb.tbl2",
      "decision":  "DENY",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id":  2, "version": 1 } } },
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tbl2-rw-user update mydb.tbl2",
      "user":      { "name": "tbl2-rw-user" },
      "access":    { "resource": { "name": "table:mydb.tbl2" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl2-rw-user update mydb.tbl2",
      "decision":  "ALLOW",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "ALLOW", "policy": { "id":  2, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tbl2-rw-user select,update mydb.tbl2",
      "user":      { "name": "tbl2-rw-user" },
      "access":    { "resource": { "name": "table:mydb.tbl2" }, "action": "update", "permissions": [ "select", "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl2-rw-user select,update mydb.tbl2",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id":  2, "version": 1 } } },
        "update": { "permission": "update", "access": { "decision": "ALLOW", "policy": { "id":  2, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tbl1-r-user select mydb.tbl2",
      "user":      { "name": "tbl1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl2" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl1-r-user select mydb.tbl2",
      "decision":  "DENY",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tbl1-r-user update mydb.tbl2",
      "user":      { "name": "tbl1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl2" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tbl1-r-user update mydb.tbl2",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "all-tbl-r-user select mydb.tbl2",
      "user":      { "name": "all-tbl-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl2" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "all-tbl-r-user select mydb.tbl2",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 3, "version": 2 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "all-tbl-r-user update mydb.tbl2",
      "user":      { "name": "all-tbl-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl2" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "all-tbl-r-user update mydb.tbl2",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },

  {
    "comment": "tests for tbl mydb.tbl_tag1"
  },
  {
    "request": {
      "requestId": "tag1-r-user select mydb.tbl_tag1",
      "user":      { "name": "tag1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag1" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag1-r-user select mydb.tbl_tag1",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 11, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tag1-r-user update mydb.tbl_tag1",
      "user":      { "name": "tag1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag1" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag1-r-user update mydb.tbl_tag1",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tag1-r-user select,update mydb.tbl_tag1",
      "user":      { "name": "tag1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag1" }, "action": "update", "permissions": [ "select", "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag1-r-user select,update mydb.tbl_tag1",
      "decision":  "DENY",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id":  11, "version": 1 } } },
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tag1-rw-user update mydb.tbl_tag1",
      "user":      { "name": "tag1-rw-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag1" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag1-rw-user update mydb.tbl_tag1",
      "decision":  "ALLOW",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "ALLOW", "policy": { "id":  11, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tag1-rw-user select,update mydb.tbl_tag1",
      "user":      { "name": "tag1-rw-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag1" }, "action": "update", "permissions": [ "select", "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag1-rw-user select,update mydb.tbl_tag1",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id":  11, "version": 1 } } },
        "update": { "permission": "update", "access": { "decision": "ALLOW", "policy": { "id":  11, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tag2-r-user select mydb.tbl_tag1",
      "user":      { "name": "tag2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag1" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag2-r-user select mydb.tbl_tag1",
      "decision":  "DENY",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tag2-r-user update mydb.tbl_tag1",
      "user":      { "name": "tag2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag1" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag2-r-user update mydb.tbl_tag1",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "all-tbl-r-user select mydb.tbl_tag1",
      "user":      { "name": "all-tbl-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag1" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "all-tbl-r-user select mydb.tbl_tag1",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 3, "version": 2 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "all-tbl-r-user update mydb.tbl_tag1",
      "user":      { "name": "all-tbl-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag1" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "all-tbl-r-user update mydb.tbl_tag1",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },


  {
    "comment": "tests for tbl mydb.tbl_tag2"
  },
  {
    "request": {
      "requestId": "tag2-r-user select mydb.tbl_tag2",
      "user":      { "name": "tag2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag2" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag2-r-user select mydb.tbl_tag2",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 12, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tag2-r-user update mydb.tbl_tag2",
      "user":      { "name": "tag2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag2" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag2-r-user update mydb.tbl_tag2",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tag2-r-user select,update mydb.tbl_tag2",
      "user":      { "name": "tag2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag2" }, "action": "update", "permissions": [ "select", "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag2-r-user select,update mydb.tbl_tag2",
      "decision":  "DENY",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id":  12, "version": 1 } } },
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tag2-rw-user update mydb.tbl_tag2",
      "user":      { "name": "tag2-rw-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag2" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag2-rw-user update mydb.tbl_tag2",
      "decision":  "ALLOW",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "ALLOW", "policy": { "id":  12, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tag2-rw-user select,update mydb.tbl_tag2",
      "user":      { "name": "tag2-rw-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag2" }, "action": "update", "permissions": [ "select", "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag2-rw-user select,update mydb.tbl_tag2",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id":  12, "version": 1 } } },
        "update": { "permission": "update", "access": { "decision": "ALLOW", "policy": { "id":  12, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tag1-r-user select mydb.tbl_tag2",
      "user":      { "name": "tag1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag2" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag1-r-user select mydb.tbl_tag2",
      "decision":  "DENY",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "tag1-r-user update mydb.tbl_tag2",
      "user":      { "name": "tag1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag2" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "tag1-r-user update mydb.tbl_tag2",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "all-tbl-r-user select mydb.tbl_tag2",
      "user":      { "name": "all-tbl-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag2" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "all-tbl-r-user select mydb.tbl_tag2",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 3, "version": 2 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "all-tbl-r-user update mydb.tbl_tag2",
      "user":      { "name": "all-tbl-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_tag2" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "all-tbl-r-user update mydb.tbl_tag2",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },


  {
    "comment": "tests for tbl mydb.tbl_ds1"
  },
  {
    "request": {
      "requestId": "ds1-r-user select mydb.tbl_ds1",
      "user":      { "name": "ds1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds1" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "ds1-r-user select mydb.tbl_ds1",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 41, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "ds1-r-user update mydb.tbl_ds1",
      "user":      { "name": "ds1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds1" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "ds1-r-user update mydb.tbl_ds1",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "ds1-r-user select,update mydb.tbl_ds1",
      "user":      { "name": "ds1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds1" }, "action": "update", "permissions": [ "select", "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "ds1-r-user select,update mydb.tbl_ds1",
      "decision":  "DENY",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id":  41, "version": 1 } } },
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "ds2-r-user select mydb.tbl_ds1",
      "user":      { "name": "ds2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds1" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "ds2-r-user select mydb.tbl_ds1",
      "decision":  "DENY",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "ds2-r-user update mydb.tbl_ds1",
      "user":      { "name": "ds2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds1" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "ds2-r-user update mydb.tbl_ds1",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "all-tbl-r-user select mydb.tbl_ds1",
      "user":      { "name": "all-tbl-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds1" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "all-tbl-r-user select mydb.tbl_ds1",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 3, "version": 2 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "all-tbl-r-user update mydb.tbl_ds1",
      "user":      { "name": "all-tbl-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds1" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "all-tbl-r-user update mydb.tbl_ds1",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },


  {
    "comment": "tests for tbl mydb.tbl_ds2"
  },
  {
    "request": {
      "requestId": "ds2-r-user select mydb.tbl_ds2",
      "user":      { "name": "ds2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds2" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "ds2-r-user select mydb.tbl_ds2",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 42, "version": 1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "ds2-r-user update mydb.tbl_ds2",
      "user":      { "name": "ds2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds2" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "ds2-r-user update mydb.tbl_ds2",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "ds2-r-user select,update mydb.tbl_ds2",
      "user":      { "name": "ds2-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds2" }, "action": "update", "permissions": [ "select", "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "ds2-r-user select,update mydb.tbl_ds2",
      "decision":  "DENY",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id":  42, "version": 1 } } },
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "ds1-r-user select mydb.tbl_ds2",
      "user":      { "name": "ds1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds2" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "ds1-r-user select mydb.tbl_ds2",
      "decision":  "DENY",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "ds1-r-user update mydb.tbl_ds2",
      "user":      { "name": "ds1-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds2" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "ds1-r-user update mydb.tbl_ds2",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "all-tbl-r-user select mydb.tbl_ds2",
      "user":      { "name": "all-tbl-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds2" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "all-tbl-r-user select mydb.tbl_ds2",
      "decision":  "ALLOW",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 3, "version": 2 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "all-tbl-r-user update mydb.tbl_ds2",
      "user":      { "name": "all-tbl-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds2" }, "action": "update", "permissions": [ "update" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "all-tbl-r-user update mydb.tbl_ds2",
      "decision":  "DENY",
      "permissions": {
        "update": { "permission": "update", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
      }
    }
  },

  {
    "comment": "tests for tbl mydb.tbl_ds3"
  },
  {
    "request": {
      "requestId": "ds3-r-user select mydb.tbl_ds3",
      "user":      { "name": "ds3-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds3" }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "ds3-r-user select mydb.tbl_ds3",
      "decision":  "DENY",
      "permissions": {
        "select": { "permission": "select", "access": { "decision": "DENY", "policy": { "id": -1 } } }
      }
    }
  },
  {
    "request": {
      "requestId": "ds3-r-user select mydb.tbl_ds3 col1,col2,col3",
      "user":      { "name": "ds3-r-user" },
      "access":    { "resource": { "name": "table:mydb.tbl_ds3", "subResources": [ "column:col1", "column:col2", "column:col3" ] }, "action": "select", "permissions": [ "select" ] },
      "context":   { "serviceName": "dev_hive" }
    },
    "result": {
      "requestId": "ds3-r-user select mydb.tbl_ds3 col1,col2,col3",
      "decision":  "ALLOW",
      "permissions": {
        "select": {
          "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 43, "version": 1 } }, "rowFilter": { "filterExpr": "year = current_year()", "policy": { "id": 43, "version": 1 } },
          "subResources": {
            "column:col1": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 43, "version": 1 } }, "dataMask": { "maskType": "MASK_HASH", "policy": { "id": 43, "version": 1 } } },
            "column:col2": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 43, "version": 1 } } },
            "column:col3": { "permission": "select", "access": { "decision": "ALLOW", "policy": { "id": 43, "version": 1 } } }
          }
        }
      }
    }
  }
]
