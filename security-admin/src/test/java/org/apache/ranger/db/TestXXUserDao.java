/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.apache.ranger.db;

import org.apache.ranger.entity.XXUser;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.MethodOrderer;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.TestMethodOrder;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.Mock;
import org.mockito.Mockito;
import org.mockito.junit.jupiter.MockitoExtension;

import javax.persistence.EntityManager;
import javax.persistence.NoResultException;
import javax.persistence.TypedQuery;

/**
 * @generated by Cursor
 * @description <Unit Test for XXUserDao class>
 */
@ExtendWith(MockitoExtension.class)
@TestMethodOrder(MethodOrderer.MethodName.class)
public class TestXXUserDao {
    @Mock
    RangerDaoManager daoManager;

    @Mock
    EntityManager entityManager;

    @Test
    public void test01findByPortalUserId_withValidId() {
        Long portalUserId = 50L;

        XXUser xxUser = new XXUser();
        xxUser.setId(100L);

        XXUserDao xxUserDao = Mockito.spy(new XXUserDao(daoManager));

        @SuppressWarnings("unchecked")
        TypedQuery<XXUser> query = Mockito.mock(TypedQuery.class);

        Mockito.doReturn(entityManager).when(xxUserDao).getEntityManager();
        Mockito.when(entityManager.createNamedQuery("XXUser.findByPortalUserId", XXUser.class)).thenReturn(query);
        Mockito.when(query.setParameter("portalUserId", portalUserId)).thenReturn(query);
        Mockito.when(query.getSingleResult()).thenReturn(xxUser);

        XXUser result = xxUserDao.findByPortalUserId(portalUserId);

        Assertions.assertNotNull(result);
        Assertions.assertEquals(100L, result.getId());
    }

    @Test
    public void test02findByPortalUserId_withNullId() {
        XXUserDao xxUserDao = new XXUserDao(daoManager);
        XXUser    result    = xxUserDao.findByPortalUserId(null);
        Assertions.assertNull(result);
    }

    @Test
    public void test03findByPortalUserId_withNoResult() {
        Long portalUserId = 999L;

        XXUserDao xxUserDao = Mockito.spy(new XXUserDao(daoManager));

        @SuppressWarnings("unchecked")
        TypedQuery<XXUser> query = Mockito.mock(TypedQuery.class);

        Mockito.doReturn(entityManager).when(xxUserDao).getEntityManager();
        Mockito.when(entityManager.createNamedQuery("XXUser.findByPortalUserId", XXUser.class)).thenReturn(query);
        Mockito.when(query.setParameter("portalUserId", portalUserId)).thenReturn(query);
        Mockito.when(query.getSingleResult()).thenThrow(new NoResultException());

        XXUser result = xxUserDao.findByPortalUserId(portalUserId);

        Assertions.assertNull(result);
    }
}
