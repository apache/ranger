{
  "id":          3,
  "name":        "hive",
  "displayName": "Hadoop SQL",
  "implClass":   "org.apache.ranger.services.hive.RangerServiceHive",
  "label":       "Hive Server2",
  "description": "Hive Server2",
  "guid":        "3e1afb5a-184a-4e82-9d9c-87a5cacc243c",
  "resources": [
    {
      "itemId":            1,
      "name":              "database",
      "parent":            "",
      "level":             10,
      "type":              "string",
      "mandatory":         true,
      "lookupSupported":   true,
      "excludesSupported": true,
      "matcher":           "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher",
      "matcherOptions":    { "wildCard": true, "ignoreCase": true },
      "label":             "Hive Database",
      "description":       "Hive Database",
      "isValidLeaf":       true
    },
    {
      "itemId":            2,
      "name":              "table",
      "parent":            "database",
      "level":             20,
      "type":              "string",
      "mandatory":         true,
      "lookupSupported":   true,
      "excludesSupported": true,
      "matcher":           "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher",
      "matcherOptions":    { "wildCard": true, "ignoreCase": true },
      "label":             "Hive Table",
      "description":       "Hive Table",
      "isValidLeaf":       true
    },
    {
      "itemId":            3,
      "name":              "udf",
      "parent":            "database",
      "level":             20,
      "type":              "string",
      "mandatory":         true,
      "lookupSupported":   true,
      "excludesSupported": true,
      "matcher":           "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher",
      "matcherOptions":    { "wildCard": true, "ignoreCase": true },
      "label":             "Hive UDF",
      "description":       "Hive UDF"
    },
    {
      "itemId":            4,
      "name":              "column",
      "parent":            "table",
      "level":             30,
      "type":              "string",
      "mandatory":         true,
      "lookupSupported":   true,
      "excludesSupported": true,
      "matcher":           "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher",
      "matcherOptions":    { "wildCard": true, "ignoreCase": true },
      "label":             "Hive Column",
      "description":       "Hive Column"
    },
    {
      "itemId":             5,
      "name":               "url",
      "parent":             "",
      "level":              10,
      "type":               "string",
      "mandatory":          true,
      "recursiveSupported": true,
      "matcher":            "org.apache.ranger.plugin.resourcematcher.RangerURLResourceMatcher",
      "matcherOptions":     { "wildCard": true, "ignoreCase": false },
      "label":              "URL",
      "description":        "URL"
    },
    {
      "itemId":         6,
      "name":           "hiveservice",
      "parent":         "",
      "level":          10,
      "type":           "string",
      "mandatory":      true,
      "matcher":        "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher",
      "matcherOptions": { "wildCard": true, "ignoreCase": false },
      "label":          "Hive Service",
      "description":    "Hive Service"
    },
    {
      "itemId":         7,
      "name":           "global",
      "parent":         "",
      "level":          10,
      "type":           "string",
      "mandatory":      true,
      "matcher":        "org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher",
      "matcherOptions": { "wildCard": true, "ignoreCase": false },
      "label":          "Global",
      "description":    "Global"
    }
  ],
  "accessTypes": [
    { "itemId": 1,  "name": "select",       "label": "select",              "category": "READ" },
    { "itemId": 2,  "name": "update",       "label": "update",              "category": "UPDATE" },
    { "itemId": 3,  "name": "create",       "label": "Create",              "category": "CREATE" },
    { "itemId": 4,  "name": "drop",         "label": "Drop",                "category": "DELETE" },
    { "itemId": 5,  "name": "alter",        "label": "Alter",               "category": "CREATE" },
    { "itemId": 6,  "name": "index",        "label": "Index",               "category": "MANAGE" },
    { "itemId": 7,  "name": "lock",         "label": "Lock",                "category": "MANAGE" },
    { "itemId": 9,  "name": "read",         "label": "Read",                "category": "READ" },
    { "itemId": 10, "name": "write",        "label": "Write",               "category": "UPDATE" },
    { "itemId": 11, "name": "repladmin",    "label": "ReplAdmin",           "category": "MANAGE" },
    { "itemId": 12, "name": "serviceadmin", "label": "Service Admin",       "category": "MANAGE" },
    { "itemId": 13, "name": "tempudfadmin", "label": "Temporary UDF Admin", "category": "MANAGE" },
    { "itemId": 14, "name": "refresh",      "label": "Refresh",             "category": "MANAGE" },
    { "itemId": 8,  "name": "all",          "label": "All", "impliedGrants": [ "select", "update", "create", "drop", "alter", "index", "lock", "read", "write", "repladmin", "serviceadmin", "refresh" ] }
  ],
  "configs": [
    { "itemId": 1, "name": "username",                    "type": "string",   "mandatory": true,  "label": "Username" },
    { "itemId": 2, "name": "password",                    "type": "password", "mandatory": true,  "label": "Password" },
    { "itemId": 3, "name": "jdbc.driverClassName",        "type": "string",   "mandatory": true,  "defaultValue": "org.apache.hive.jdbc.HiveDriver" },
    { "itemId": 4, "name": "jdbc.url",                    "type": "string",   "mandatory": true,  "defaultValue": "", "uiHint":"{\"TextFieldWithIcon\":true, \"info\": \"1.For Remote Mode, eg.<br>jdbc:hive2://&lt;host&gt;:&lt;port&gt;<br>2.For Embedded Mode (no host or port), eg.<br>jdbc:hive2:///;initFile=&lt;file&gt;<br>3.For HTTP Mode, eg.<br>jdbc:hive2://&lt;host&gt;:&lt;port&gt;/;<br>transportMode=http;httpPath=&lt;httpPath&gt;<br>4.For SSL Mode, eg.<br>jdbc:hive2://&lt;host&gt;:&lt;port&gt;/;ssl=true;<br>sslTrustStore=tStore;trustStorePassword=pw<br>5.For ZooKeeper Mode, eg.<br>jdbc:hive2://&lt;host&gt;/;serviceDiscoveryMode=<br>zooKeeper;zooKeeperNamespace=hiveserver2<br>6.For Kerberos Mode, eg.<br>jdbc:hive2://&lt;host&gt;:&lt;port&gt;/;<br>principal=hive/domain@EXAMPLE.COM<br>\"}"
    },
    { "itemId": 5, "name": "commonNameForCertificate",    "type": "string",   "mandatory": false, "label": "Common Name for Certificate" },
    { "itemId": 6, "name": "ranger.plugin.audit.filters", "type": "string",   "mandatory": false, "label": "Ranger Default Audit Filters", "defaultValue": "[ {'accessResult': 'DENIED', 'isAudited': true}, {'actions':['METADATA OPERATION'], 'isAudited': false}, {'users':['hive','hue'],'actions':['SHOW_ROLES'],'isAudited':false} ]" }
  ],
  "dataMaskDef": {
    "accessTypes": [
      { "name": "select" }
    ],
    "resources": [
      { "name": "database", "matcherOptions": { "wildCard": "false" }, "lookupSupported": true, "uiHint":"{ \"singleValue\":true }" },
      { "name": "table",    "matcherOptions": { "wildCard": "false" }, "lookupSupported": true, "uiHint":"{ \"singleValue\":true }" },
      { "name": "column",   "matcherOptions": { "wildCard": "false" }, "lookupSupported": true, "uiHint":"{ \"singleValue\":true }" }
    ],
    "maskTypes": [
      {
        "itemId":      1,
        "name":        "MASK",
        "label":       "Redact",
        "description": "Replace lowercase with 'x', uppercase with 'X', digits with '0'",
        "transformer": "mask({col})"
      },
      {
        "itemId":      2,
        "name":        "MASK_SHOW_LAST_4",
        "label":       "Partial mask: show last 4",
        "description": "Show last 4 characters; replace rest with 'x'",
        "transformer": "mask_show_last_n({col}, 4, 'x', 'x', 'x', -1, '1')"
      },
      {
        "itemId":      3,
        "name":        "MASK_SHOW_FIRST_4",
        "label":       "Partial mask: show first 4",
        "description": "Show first 4 characters; replace rest with 'x'",
        "transformer": "mask_show_first_n({col}, 4, 'x', 'x', 'x', -1, '1')"
      },
      {
        "itemId":      4,
        "name":        "MASK_HASH",
        "label":       "Hash",
        "description": "Hash the value",
        "transformer": "mask_hash({col})"
      },
      {
        "itemId":      5,
        "name":        "MASK_NULL",
        "label":       "Nullify",
        "description": "Replace with NULL"
      },
      {
        "itemId":      6,
        "name":        "MASK_NONE",
        "label":       "Unmasked (retain original value)",
        "description": "No masking"
      },
      {
        "itemId":      12,
        "name":        "MASK_DATE_SHOW_YEAR",
        "label":       "Date: show only year",
        "description": "Date: show only year",
        "transformer": "mask({col}, 'x', 'x', 'x', -1, '1', 1, 0, -1)"
      },
      {
        "itemId":      13,
        "name":        "CUSTOM",
        "label":       "Custom",
        "description": "Custom"
      }
    ]
  },
  "rowFilterDef": {
    "accessTypes": [
      { "name": "select" }
    ],
    "resources": [
      { "name": "database", "matcherOptions": { "wildCard": "false" }, "lookupSupported": true, "mandatory": true, "uiHint": "{ \"singleValue\":true }" },
      { "name": "table",    "matcherOptions": { "wildCard": "false" }, "lookupSupported": true, "mandatory": true, "uiHint": "{ \"singleValue\":true }" }
    ]
  }
}
