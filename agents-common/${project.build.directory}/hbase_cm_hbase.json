{"serviceName":"cm_hbase","serviceId":3,"policyVersion":7141,"policies":[{"id":4,"isEnabled":true,"name":"all - table, column-family, column","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["prospects","invoices"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"users":["hbase","hive"],"groups":["pr00_xbgdta"],"delegateAdmin":true},{"accesses":[{"type":"read","isAllowed":true},{"type":"create","isAllowed":true}],"users":["rangerlookup"],"delegateAdmin":false},{"accesses":[{"type":"read","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["qqsens","fb00_xbgdta"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":5,"isEnabled":true,"name":"ATLAS_HBASE_TABLES","policyPriority":0,"isAuditEnabled":false,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["atlas_janus","ATLAS_ENTITY_AUDIT_EVENTS"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"users":["atlas"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":782,"isEnabled":true,"name":"SYSTEM","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["SYSTEM:*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"execute","isAllowed":true}],"users":["{USER}"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":821,"isEnabled":true,"name":"fb00_xda017","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["vfb00_*vda0171*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["vfb00_vxda017","xagcla"],"delegateAdmin":false}],"serviceType":"hbase","isDenyAllElse":false},{"id":822,"isEnabled":true,"name":"fb00_xda029","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*da029*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xda029"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":823,"isEnabled":true,"name":"fb00_xda034","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*da034*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xda034"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":824,"isEnabled":true,"name":"fb00_xda035","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*da035*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xda035"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":825,"isEnabled":true,"name":"fb00_xda041","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*da041*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xda041"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":826,"isEnabled":true,"name":"fb00_xda043","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*da043*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xda043"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":827,"isEnabled":true,"name":"fb00_xda052","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*da052*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xda052"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":828,"isEnabled":true,"name":"fb00_xda060","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*da060*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xda060"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":829,"isEnabled":true,"name":"fb00_xda066","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*da066*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xda066"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":830,"isEnabled":true,"name":"fb00_xda085","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*da085*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xda085"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":831,"isEnabled":true,"name":"fb00_xda092","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*da092*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xda092"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":832,"isEnabled":true,"name":"fb00_xda126","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*da126*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xda126"],"delegateAdmin":false},{"accesses":[{"type":"read","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xda085"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":833,"isEnabled":true,"name":"fb00_xds020","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*ds020*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xds020"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":834,"isEnabled":true,"name":"fb00_xoi022","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*oi022*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xoi022"],"delegateAdmin":false},{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_braff","fb00_bbrut"],"delegateAdmin":false},{"accesses":[{"type":"read","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xoi099","fb00_xoi098","fb00_xoi097","sd00_xlx001","fb00_xda085","fb00_xda126","fb00_xda017","qqsens","fb00_xda062","fb00_xpr203","fb00_xda144","fb00_xda143","fb00_xda108","fb00_xoi033","fb00_xda042","fb00_xpx091","fb00_xda107"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":835,"isEnabled":true,"name":"fb00_xoi025","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*oi025*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xoi025"],"delegateAdmin":false}],"isDenyAllElse":false},{"id":836,"isEnabled":true,"name":"fb00_xoi033","policyPriority":0,"isAuditEnabled":true,"resources":{"column-family":{"values":["*"],"isExcludes":false,"isRecursive":false},"column":{"values":["*"],"isExcludes":false,"isRecursive":false},"table":{"values":["fb00_*oi033*"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"create","isAllowed":true},{"type":"admin","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xoi033"],"delegateAdmin":false},{"accesses":[{"type":"read","isAllowed":true},{"type":"execute","isAllowed":true}],"groups":["fb00_xpr203"],"delegateAdmin":false}],"isDenyAllElse":false}],"serviceDef":{"id":2,"isEnabled":true,"name":"hbase","implClass":"org.apache.ranger.services.hbase.RangerServiceHBase","options":{"enableDenyAndExceptionsInPolicies":"true"},"configs":[{"itemId":1,"name":"username","type":"string","mandatory":true,"label":"Username"},{"itemId":2,"name":"password","type":"password","mandatory":true,"label":"Password"},{"itemId":3,"name":"hadoop.security.authentication","type":"enum","subType":"authnType","mandatory":true,"defaultValue":"simple"},{"itemId":4,"name":"hbase.master.kerberos.principal","type":"string","mandatory":false},{"itemId":5,"name":"hbase.security.authentication","type":"enum","subType":"authnType","mandatory":true,"defaultValue":"simple"},{"itemId":6,"name":"hbase.zookeeper.property.clientPort","type":"int","mandatory":true,"defaultValue":"2181"},{"itemId":7,"name":"hbase.zookeeper.quorum","type":"string","mandatory":true},{"itemId":8,"name":"zookeeper.znode.parent","type":"string","mandatory":true,"defaultValue":"/hbase"},{"itemId":9,"name":"commonNameForCertificate","type":"string","mandatory":false,"label":"Common Name for Certificate"},{"itemId":10,"name":"ranger.plugin.audit.filters","type":"string","mandatory":false,"defaultValue":"[{'accessResult': 'DENIED', 'isAudited': true},{'resources':{'table':{'values':['*-ROOT-*','*.META.*', '*_acl_*', 'hbase:meta', 'hbase:acl', 'default', 'hbase']}}, 'users':['hbase'], 'isAudited': false }, {'resources':{'table':{'values':['atlas_janus','ATLAS_ENTITY_AUDIT_EVENTS']},'column-family':{'values':['*']},'column':{'values':['*']}},'users':['atlas', 'hbase'],'isAudited':false},{'users':['hbase'], 'actions':['balance'],'isAudited':false}]","label":"Ranger Default Audit Filters"}],"resources":[{"itemId":1,"name":"table","type":"string","level":10,"mandatory":true,"lookupSupported":true,"recursiveSupported":false,"excludesSupported":true,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"true","ignoreCase":"false"},"label":"HBase Table","description":"HBase Table","isValidLeaf":false},{"itemId":2,"name":"column-family","type":"string","level":20,"parent":"table","mandatory":true,"lookupSupported":true,"recursiveSupported":false,"excludesSupported":true,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"true","ignoreCase":"false"},"label":"HBase Column-family","description":"HBase Column-family","isValidLeaf":false},{"itemId":3,"name":"column","type":"string","level":30,"parent":"column-family","mandatory":true,"lookupSupported":false,"recursiveSupported":false,"excludesSupported":true,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"true","ignoreCase":"false"},"label":"HBase Column","description":"HBase Column","isValidLeaf":true}],"accessTypes":[{"itemId":1,"name":"read","label":"Read"},{"itemId":2,"name":"write","label":"Write"},{"itemId":3,"name":"create","label":"Create"},{"itemId":4,"name":"admin","label":"Admin","impliedGrants":["read","write","create"]},{"itemId":5,"name":"execute","label":"Execute"}],"contextEnrichers":[{"itemId":1,"name":"gdsInfoEnricher","enricher":"org.apache.ranger.plugin.contextenricher.RangerGdsEnricher","enricherOptions":{"refresherPollingInterval":"60000","retrieverClassName":"org.apache.ranger.plugin.contextenricher.RangerAdminGdsInfoRetriever"}}],"enums":[{"itemId":1,"name":"authnType","elements":[{"itemId":1,"name":"simple","label":"Simple"},{"itemId":2,"name":"kerberos","label":"Kerberos"}],"defaultIndex":0}],"dataMaskDef":{},"rowFilterDef":{}},"auditMode":"audit-default","tagPolicies":{"serviceName":"cm_tag","serviceId":2,"policies":[{"id":3,"isEnabled":true,"name":"EXPIRES_ON","policyPriority":0,"isAuditEnabled":true,"resources":{"tag":{"values":["EXPIRES_ON"],"isExcludes":false,"isRecursive":false}},"denyPolicyItems":[{"accesses":[{"type":"execute","isAllowed":true},{"type":"create","isAllowed":true},{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"admin","isAllowed":true}],"groups":["public"],"conditions":[{"type":"accessed-after-expiry","values":["yes"]}],"delegateAdmin":false}],"isDenyAllElse":false},{"id":780,"isEnabled":true,"name":"kw_raffinageonly","policyPriority":0,"isAuditEnabled":true,"resources":{"tag":{"values":["kw_raffinageonly"],"isExcludes":false,"isRecursive":false}},"policyItems":[{"accesses":[{"type":"execute","isAllowed":true},{"type":"create","isAllowed":true},{"type":"read","isAllowed":true},{"type":"write","isAllowed":true},{"type":"admin","isAllowed":true}],"groups":["fb00_braff","pr00_braff","hadoop"],"delegateAdmin":false}],"isDenyAllElse":false}],"serviceDef":{"id":100,"isEnabled":true,"name":"tag","displayName":"tag","implClass":"org.apache.ranger.services.tag.RangerServiceTag","label":"TAG","description":"TAG Service Definition","options":{"ui.pages":"tag-based-policies"},"configs":[{"itemId":1,"name":"ranger.plugin.audit.filters","type":"string","mandatory":false,"defaultValue":"[ {'accessResult': 'DENIED', 'isAudited': true} ]","label":"Ranger Default Audit Filters"}],"resources":[{"itemId":1,"name":"tag","type":"string","level":1,"mandatory":true,"lookupSupported":true,"recursiveSupported":false,"excludesSupported":false,"matcher":"org.apache.ranger.plugin.resourcematcher.RangerDefaultResourceMatcher","matcherOptions":{"wildCard":"false","ignoreCase":"false"},"uiHint":"{ \"singleValue\":true }","label":"TAG","description":"TAG"}],"policyConditions":[{"itemId":1,"name":"accessed-after-expiry","evaluator":"org.apache.ranger.plugin.conditionevaluator.RangerScriptTemplateConditionEvaluator","evaluatorOptions":{"scriptTemplate":"ctx.isAccessedAfter('expiry_date');"},"uiHint":"{ \"singleValue\":true }","label":"Accessed after expiry_date (yes/no)?","description":"Accessed after expiry_date? (yes/no)"},{"itemId":2,"name":"expression","evaluator":"org.apache.ranger.plugin.conditionevaluator.RangerScriptConditionEvaluator","evaluatorOptions":{"engineName":"JavaScript","ui.isMultiline":"true"},"uiHint":"{ \"isMultiline\":true }","label":"Enter boolean expression","description":"Boolean expression"}],"contextEnrichers":[{"itemId":1,"name":"TagEnricher","enricher":"org.apache.ranger.plugin.contextenricher.RangerTagEnricher","enricherOptions":{"tagRetrieverClassName":"org.apache.ranger.plugin.contextenricher.RangerAdminTagRetriever","tagRefresherPollingInterval":"60000"}}],"dataMaskDef":{},"rowFilterDef":{}},"auditMode":"audit-default"},"serviceConfig":{"ranger.plugin.audit.filters":"[{'accessResult':'DENIED','isAudited':true},{'resources':{'table':{'values':['*-ROOT-*','*.META.*','*_acl_*','hbase:meta','hbase:acl','default','hbase'],'isExcludes':true}},'users':['hbase'],'isAudited':false},{'resources':{'table':{'values':['atlas_janus','ATLAS_ENTITY_AUDIT_EVENTS'],'isExcludes':true},'column-family':{'values':['*'],'isExcludes':true},'column':{'values':['*'],'isExcludes':true}},'users':['atlas','hbase'],'isAudited':false},{'users':['hbase'],'actions':['balance'],'isAudited':false}]"}}